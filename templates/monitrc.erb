# /etc/monit/monitrc - Monit Configuration file
# 
# This file is handled by puppet, any local changes will be lost
#

set alert <%= scope.scope.lookupvar('monit::alert') %>

<% if scope.scope.lookupvar('monit::enable_httpd') == 'yes' -%>
set httpd port <%= scope.scope.lookupvar('monit::httpd_port') %> and use address localhost
    allow localhost
<%
require 'digest/sha1'
s=scope.scope.lookupvar('monit::secret')
-%>
    allow monit:<%= Digest::SHA1.hexdigest(s + Digest::SHA1.hexdigest(s + fqdn)) %> 
<% end -%>

set daemon <%= scope.scope.lookupvar('monit::pool_interval') %>
set logfile syslog facility log_daemon
set mailserver <%= scope.scope.lookupvar('monit::mailserver') %>

# Include settings from other files
include /etc/monit/conf.d/*.monitrc
