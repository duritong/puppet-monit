# /etc/monit/monitrc - Monit Configuration file
# 
# This file is handled by puppet, any local changes will be lost
#

<% unless scope.lookupvar('monit::alert') == 'absent' -%>
set alert <%= scope.lookupvar('monit::alert') %>

<% end %>
<% unless monit::mailserver == 'absent' -%>
set mailserver <%= scope.lookupvar('monit::mailserver') %>

<% end -%>
<% if scope.lookupvar('monit::enable_httpd') == 'yes' -%>
set httpd port <%= scope.lookupvar('monit::httpd_port') %> and use address localhost
    allow localhost
<%
require 'digest/sha1'
s=scope.lookupvar('monit::secret')
-%>
    allow monit:<%= Digest::SHA1.hexdigest(s + Digest::SHA1.hexdigest(s + fqdn)) %> 
<% end -%>

set daemon <%= scope.lookupvar('monit::pool_interval') %>
set logfile syslog facility log_daemon

# Include settings from other files
include /etc/monit/conf.d/*.monitrc
